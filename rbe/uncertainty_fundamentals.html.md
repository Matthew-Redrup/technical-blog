# RBE Part 1: Uncertainty Fundamentals


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Introduction: Why Uncertainty Matters in Cybersecurity

In cybersecurity, we constantly make decisions under uncertainty.
Consider these scenarios:

1.  **Network Anomaly Detection**: Is this unusual traffic pattern a
    cyberattack or normal variation?
2.  **Threat Intelligence**: How confident are we that this IP address
    is malicious?
3.  **Incident Response**: What’s the probability this breach came from
    an insider threat?

Traditional approaches often ignore uncertainty, leading to brittle
systems that fail when conditions change. Recursive Bayesian Estimation
(RBE) provides a principled framework for handling uncertainty that
evolves over time.

Let’s start with a concrete example:

``` python
# Example: Network intrusion detection uncertainty
# We observe suspicious activity but aren't sure if it's an attack

# Prior belief: 5% of network events are attacks
prior_attack = 0.05
prior_normal = 0.95
prior = np.array([prior_attack, prior_normal])

print(f"Prior belief: {prior_attack*100:.1f}% chance of attack")
print(f"Uncertainty (entropy): {prob_entropy(prior):.3f} bits")
```

    Prior belief: 5.0% chance of attack
    Uncertainty (entropy): 0.286 bits

This entropy measure tells us how uncertain we are. Higher entropy =
more uncertainty. Now let’s see how new evidence changes our beliefs:

``` python
# New evidence: unusual port scanning detected
# Likelihood: attacks cause port scanning 90% of the time
#            normal traffic causes it 10% of the time
likelihood = np.array([0.9, 0.1])  # [P(evidence|attack), P(evidence|normal)]

# Update beliefs using Bayes' theorem
posterior = bayes_update(prior, likelihood)

print(f"After observing port scanning:")
print(f"Updated belief: {posterior[0]*100:.1f}% chance of attack")
print(f"New uncertainty: {prob_entropy(posterior):.3f} bits")
print(f"Uncertainty reduction: {prob_entropy(prior) - prob_entropy(posterior):.3f} bits")
```

    After observing port scanning:
    Updated belief: 32.1% chance of attack
    New uncertainty: 0.906 bits
    Uncertainty reduction: -0.620 bits

Notice how the evidence both **increased our confidence** in an attack
and **reduced our uncertainty**. This is the essence of Bayesian
reasoning - we start with prior beliefs and update them as we gather
evidence.

## Types of Uncertainty

Understanding uncertainty requires distinguishing between two
fundamental types:

### Aleatory Uncertainty (Irreducible)

**Inherent randomness** in the system that cannot be reduced by
gathering more data.

**Cybersecurity Examples:** - Random timing of legitimate user logins -
Network packet loss due to congestion - Attacker’s choice of target
systems

### Epistemic Uncertainty (Reducible)

**Lack of knowledge** that can be reduced by collecting more
information.

**Cybersecurity Examples:** - Unknown attack signatures - Incomplete
threat intelligence - Uncertain system configurations

------------------------------------------------------------------------

<a
href="https://github.com/Matthew-Redrup/technical-blog/blob/main/technical_blog/rbe/uncertainty.py#L20"
target="_blank" style="float:right; font-size:smaller">source</a>

### demo_uncertainty_types

>  demo_uncertainty_types (n_samples=1000, rng=None)

*Demonstrate aleatory vs epistemic uncertainty with cybersecurity
examples*

**Key Insight**: RBE excels at handling epistemic uncertainty. As we
collect more evidence, our beliefs converge toward the truth. Aleatory
uncertainty remains, but we can quantify and account for it.

## Mathematical Foundations

Let’s build our mathematical toolkit using the core functions. We’ll
start with probability distributions and work toward Bayesian inference.

### Probability Distributions and Entropy

------------------------------------------------------------------------

<a
href="https://github.com/Matthew-Redrup/technical-blog/blob/main/technical_blog/rbe/uncertainty.py#L72"
target="_blank" style="float:right; font-size:smaller">source</a>

### explore_distributions

>  explore_distributions ()

*Interactive exploration of probability distributions and entropy*

**Entropy Interpretation:** - **High entropy** (uniform): We’re
completely uncertain about the threat level - **Low entropy** (certain):
We’re confident in our assessment - **Information gain**: Entropy
reduction when we receive evidence

### Bayes’ Theorem in Action

Now let’s see how Bayes’ theorem works in practice for cybersecurity
scenarios:

------------------------------------------------------------------------

<a
href="https://github.com/Matthew-Redrup/technical-blog/blob/main/technical_blog/rbe/uncertainty.py#L127"
target="_blank" style="float:right; font-size:smaller">source</a>

### bayesian_intrusion_detection

>  bayesian_intrusion_detection (n_observations=10, rng=None)

*Demonstrate Bayesian updating for intrusion detection*

**Key Observations:** 1. **Sequential updating**: Each piece of evidence
refines our beliefs 2. **Evidence strength matters**: Port scans have
bigger impact than normal traffic 3. **Counter-evidence**: Normal
traffic observations reduce attack probability 4. **Uncertainty
tracking**: We can quantify how confident we are

### Handling Multiple Hypotheses

In real cybersecurity scenarios, we often consider multiple threat types
simultaneously:

------------------------------------------------------------------------

<a
href="https://github.com/Matthew-Redrup/technical-blog/blob/main/technical_blog/rbe/uncertainty.py#L183"
target="_blank" style="float:right; font-size:smaller">source</a>

### multi_threat_assessment

>  multi_threat_assessment (rng=None)

*Demonstrate multi-hypothesis threat assessment*

## Interactive Uncertainty Explorer

Let’s create an interactive component to explore how different evidence
affects our beliefs:

------------------------------------------------------------------------

<a
href="https://github.com/Matthew-Redrup/technical-blog/blob/main/technical_blog/rbe/uncertainty.py#L244"
target="_blank" style="float:right; font-size:smaller">source</a>

### create_uncertainty_calculator

>  create_uncertainty_calculator ()

*Create an interactive uncertainty calculator using FastHTML*

## Summary: Key Takeaways

We’ve explored the fundamentals of uncertainty in cybersecurity through
the lens of Bayesian reasoning:

### Core Concepts

1.  **Two Types of Uncertainty**:
    - **Aleatory** (irreducible): Inherent randomness in systems
    - **Epistemic** (reducible): Our lack of knowledge
2.  **Entropy as Uncertainty Measure**:
    - Quantifies how uncertain we are about outcomes
    - Information gain = entropy reduction
3.  **Bayesian Updating**:
    - Start with prior beliefs
    - Update with evidence using Bayes’ theorem
    - Track uncertainty throughout the process

### Practical Applications

- **Network intrusion detection** with evolving threat assessments
- **Multi-hypothesis testing** for different attack types
- **Evidence accumulation** over time
- **Uncertainty quantification** for decision making

### Next Steps

In the next notebook, we’ll explore how to implement these concepts
using **Recursive Bayesian Estimation** with particle filters for
real-time cybersecurity applications.

The mathematical foundation we’ve built here provides the basis for more
sophisticated techniques that can handle: - Non-linear system dynamics -
Multi-dimensional state spaces - Continuous-time observations - Adaptive
learning algorithms
